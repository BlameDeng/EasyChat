(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-200924c1"],{"21fd":function(t,e,n){"use strict";var s=n("8932"),i=n.n(s);i.a},4767:function(t,e,n){},"4f91":function(t,e,n){"use strict";var s=function(){var t,e,n=this,s=n.$createElement,i=n._self._c||s;return"textarea"===n.type?i("div",{staticClass:"x-textarea-wrapper"},[i("textarea",{ref:"myTextarea",style:n.xStyle,domProps:{value:n.value},on:{change:function(t){n.$emit("change",t)},input:n.onInput,focus:function(t){n.$emit("focus",t)},blur:function(t){n.$emit("blur",t)}}})]):i("div",{staticClass:"x-input",class:{error:n.error,disabled:n.disabled}},[n.icon?i("x-icon",{staticClass:"icon",class:{focus:n.focus||n.value},attrs:{name:n.icon}}):n._e(),i("x-icon",{staticClass:"error",attrs:{name:"error"}}),i("input",{ref:"input",class:(t={},t["no-icon"]=!n.icon,t),attrs:{type:n.type},domProps:{value:n.value},on:{focus:n.onFocus,blur:n.onBlur,input:n.onInput,change:n.onChange}}),n.placeholder?i("label",{class:(e={focus:n.focus||n.value},e["no-icon"]=!n.icon,e)},[n._v(n._s(n.placeholder))]):n._e()],1)},i=[],r=n("61e6"),a={name:"xInput",components:{xIcon:r["a"]},props:{placeholder:String,value:String,icon:String,type:{type:String,default:"text"},disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},resize:{type:Boolean,default:!1}},data:function(){return{focus:!1}},computed:{xStyle:function(){return this.resize?{resize:"auto"}:{resize:"none"}}},methods:{onFocus:function(t){this.focus=!0,this.$emit("focus",t),this.disabled&&this.$refs.input.blur()},onBlur:function(t){this.disabled||(this.focus=!1,this.$emit("blur",t))},onInput:function(t){this.$emit("input",t.target.value)},onChange:function(t){this.$emit("change",t)}}},c=a,o=(n("21fd"),n("2877")),u=Object(o["a"])(c,s,i,!1,null,"7f91d424",null);u.options.__file="input.vue";e["a"]=u.exports},"7f7f":function(t,e,n){var s=n("86cc").f,i=Function.prototype,r=/^\s*function ([^ (]*)/,a="name";a in i||n("9e1e")&&s(i,a,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(t){return""}}})},8932:function(t,e,n){},"95b5":function(t,e,n){"use strict";var s=n("4767"),i=n.n(s);i.a},e538:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"contract"},[n("div",{staticClass:"nav"},[n("div",{staticClass:"title"},[n("div",{staticClass:"chat"},[t._v("联系人")]),n("div",{staticClass:"icon-wrapper",attrs:{title:"发起群聊"}},[n("x-icon",{staticClass:"icon",attrs:{name:"close"},on:{click:function(e){t.selectVisible=!0}}})],1)]),t.friendsList&&t.friendsList.length?t._l(t.friendsList,function(e){return n("div",{key:e.uid,staticClass:"card",on:{click:function(n){t.currentUid=e.uid}}},[n("img",{attrs:{src:e.avatar}}),n("div",{staticClass:"content"},[n("div",{staticClass:"name"},[n("span",{staticClass:"nickyname"},[t._v(t._s(e.nickyname))])])])])}):t._e()],2),n("div",{staticClass:"content"},[t.currentFriend?n("div",{staticClass:"friend"},[n("div",{staticClass:"detail"},[n("div",{staticClass:"name"},[t._v("\n                    "+t._s(t.currentFriend.nickyname)+"\n                ")]),n("img",{attrs:{src:t.currentFriend.avatar}})]),n("div",{staticClass:"action"},[n("div",{staticClass:"button",attrs:{role:"button"},on:{click:t.onSend}},[t._v("发消息")])])]):n("div",{staticClass:"bg"},[n("x-icon",{staticClass:"icon",attrs:{name:"logo-copy"}})],1)]),n("transition",{attrs:{name:"fade"}},[t.selectVisible?n("div",{staticClass:"mask"}):t._e()]),n("transition",{attrs:{name:"fade"}},[t.selectVisible?n("div",{staticClass:"select"},[t.friendsList&&t.friendsList.length?n("div",{staticClass:"friends"},[n("span",[t._v("请勾选需要添加的联系人")]),t._l(t.friendsList,function(e){return n("div",{key:e.uid,staticClass:"card",on:{click:function(n){t.currentUid=e.uid}}},[n("img",{attrs:{src:e.avatar}}),n("div",{staticClass:"content"},[n("div",{staticClass:"name"},[n("span",{staticClass:"nickyname"},[t._v(t._s(e.nickyname))])])]),n("div",{staticClass:"check",class:{checked:t.selectedUids&&t.selectedUids.indexOf(e.uid)>-1},on:{click:function(n){t.onCheck(e.uid)}}},[n("div",{staticClass:"dot"})])])})],2):t._e(),n("div",{staticClass:"selected"},[n("x-input",{staticStyle:{width:"90%","margin-left":"5px"},attrs:{placeholder:"请输入群聊名称"},model:{value:t.name,callback:function(e){t.name="string"===typeof e?e.trim():e},expression:"name"}}),n("br"),n("span",[t._v("已添加"+t._s(t.selectedUids&&t.selectedUids.length||0)+"位联系人")]),t.selectedFriends&&t.selectedFriends.length?t._l(t.selectedFriends,function(e){return n("div",{key:e.uid,staticClass:"card"},[n("img",{attrs:{src:e.avatar}}),n("div",{staticClass:"content"},[n("div",{staticClass:"name"},[n("span",{staticClass:"nickyname"},[t._v(t._s(e.nickyname))])])])])}):t._e(),n("div",{staticClass:"btns"},[n("div",{staticClass:"button",class:{disabled:!t.selectedUids||t.selectedUids.length<2},on:{click:t.submit}},[t._v("确定")]),n("div",{staticClass:"button cancle",on:{click:function(e){t.selectVisible=!1}}},[t._v("取消")])])],2)]):t._e()])],1)},i=[],r=(n("7f7f"),n("96cf"),n("1da1")),a=(n("ac6a"),n("7514"),n("be94")),c=n("61e6"),o=n("4f91"),u=n("2f62"),d={name:"Contract",components:{xIcon:c["a"],xInput:o["a"]},data:function(){return{currentUid:"",selectVisible:!1,selectedUids:null,name:""}},computed:Object(a["a"])({},Object(u["d"])({userInfo:function(t){return t.userInfo},friendsList:function(t){return t.friendsList},conversations:function(t){return t.conversations},client:function(t){return t.client}}),{ids:function(){return this.userInfo?this.userInfo.friends:null},currentFriend:function(){var t=this;return this.currentUid&&this.friendsList&&this.friendsList.length?this.friendsList.find(function(e){return e.uid===t.currentUid}):null},selectedFriends:function(){var t=this;if(this.selectedUids&&this.selectedUids.length&&this.friendsList&&this.friendsList.length){var e=[];return this.friendsList.forEach(function(n){t.selectedUids.indexOf(n.uid)>-1&&e.push(n)}),e}return null}}),watch:{selectVisible:function(t){t||(this.name="")}},mounted:function(){var t=this;this.getFriendsList({ids:this.ids}).then(function(e){var n=[];e.forEach(function(t){var e=t[0].attributes,s=e.nickyname,i=e.avatar,r=e.uid;n.push({nickyname:s,avatar:i,uid:r})}),t.setFriendsList(n)})},methods:Object(a["a"])({},Object(u["c"])(["setFriendsList","setCurrentConversationId","setChatTarget","addConversation"]),Object(u["b"])(["getFriendsList"]),{onSend:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.conversations&&this.conversations.length){t.next=5;break}return t.next=3,this.createConversation();case 3:return this.$router.push("/user/conversation"),t.abrupt("return");case 5:if(e="",this.conversations.forEach(function(t){var s=t.members;2===s.length&&s.indexOf(n.currentUid)>-1&&(e=t.id)}),!e){t.next=13;break}this.setChatTarget(this.currentFriend),this.setCurrentConversationId(e),this.$router.push("/user/conversation"),t.next=17;break;case 13:return t.next=15,this.createConversation();case 15:return this.$router.push("/user/conversation"),t.abrupt("return");case 17:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),createConversation:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.client.createConversation({members:[this.currentUid],name:"",unique:!0});case 2:e=t.sent,this.conversations.find(function(t){return t.id===e.id})||this.addConversation(e),this.setChatTarget(this.currentFriend),this.setCurrentConversationId(e.id);case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),onCheck:function(t){this.selectedUids=this.selectedUids||[];var e=this.selectedUids.indexOf(t);-1===e?this.selectedUids.push(t):this.selectedUids.splice(e,1)},submit:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.selectedUids&&!(this.selectedUids.length<2)){t.next=2;break}return t.abrupt("return");case 2:return e=this.name,e||(e=this.selectedFriends.reduce(function(t,e){return t+e.nickyname+"、"},""),e=e.substring(0,e.length-1)),t.next=6,this.client.createConversation({members:this.selectedUids,name:e,unique:!0});case 6:n=t.sent,this.conversations.find(function(t){return t.id===n.id})||this.addConversation(n);case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()})},l=d,f=(n("95b5"),n("2877")),h=Object(f["a"])(l,s,i,!1,null,"31e4c915",null);h.options.__file="Contract.vue";e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-200924c1.1782d8ae.js.map